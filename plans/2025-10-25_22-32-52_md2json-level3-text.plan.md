# Plan: Preserve level-2 content alongside level-3 criteria

Ensure `###` subsections add child headers but do not suppress the parent level-2 criterionâ€™s own text/list content, and make sub-header content formatting consistent.

## Tasks

- [x] Clarify the spec so level-2 criteria always emit their own text/list nodes even when level-3 children exist, and describe how sub-header text/list should be structured.
  > **Edit** `apply_patch` (specs/lib/md2json/md2json.spec.md)
  >
  > Added bullet points specifying that `##` nodes stay as criteria regardless of nested `###`, and that sub-headers follow the same text/list format.
- [x] Update the converter implementation accordingly (flush logic + grouped list handling), then rebuild the CLI/tests.
  > **Edit** `apply_patch` (lib/gulp/model/data/dataElement.js)
  >
  > Adjusted `processHeader` so level-2 headers with nested children now still emit their own `CriteriaData` entries while also recording grouping metadata; nested headers continue to register under the parent group via `criteriaGroup`.
  > ---
  > **MCP** `tessl - build`
  > - spec: ["specs/lib/md2json/md2json.spec.md"]
  >
  > Confirmed no additional converter changes were required beyond the earlier spec edit because the grouping fix lives in the data model.
  > ---
  > **MCP** `tessl - build-tests`
  > - spec: ["specs/lib/md2json/md2json.spec.md"]
  >
  > Regenerated tests to keep the spec-tooling hash in sync.
- [x] Re-run `npm run data:prepare` (or equivalent) to confirm the output still builds successfully.
  > **Bash** `{"command":["bash","-lc","npm run data:prepare"],"workdir":"/home/cb/projects/github/ultimate-comparison-framework","with_escalated_permissions":true,"justification":"Verify gulp after header detection fix.","timeout_ms":120000}`
  >
  > Pipeline now completes with the new converter + grouping logic; final `dist/data.json` retains both level-2 and level-3 criteria entries.
