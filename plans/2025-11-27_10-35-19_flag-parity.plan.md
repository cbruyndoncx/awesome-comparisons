# Plan: Extend dataset/clean flags to dev/start workflows

Goal: Ensure interactive commands (dev/start) accept the same dataset selection and clean build flags as the build command for consistent workflows.

## Tasks

- [x] Audit existing npm scripts to confirm which entries need new flag support and how args currently flow (esp. dev/start concurrency commands).
  > **Bash** `['bash','-lc','sed -n '\''1,40p'\'' package.json']`
  > Reviewed [package.json](../package.json) scripts to see current `dev`/`start` definitions (both rely on inline `concurrently` commands), confirming we need wrapper scripts to intercept dataset/clean flags before invoking the existing sub-commands.
- [x] Implement shared CLI parsing/cleaning plus new runner scripts so dev/start honor dataset + clean flags while preserving current behavior.
  > **Bash** `['bash','-lc','mkdir -p scripts/lib']`
  > Created shared script directory for reusable helpers.
  > ---
  > **Bash** `['bash','-lc','cat scripts/run-build.js']`
  > Captured existing flag parsing logic to mirror in shared utilities.
  > ---
  > **Bash** `['bash','-lc','cat <<'\''EOF'\'' > scripts/lib/dataset-runner-utils.js ... EOF']`
  > Extracted dataset/clean flag parsing and clean-up helpers into [scripts/lib/dataset-runner-utils.js](../scripts/lib/dataset-runner-utils.js) for reuse.
  > ---
  > **Bash** `['bash','-lc','cat <<'\''EOF'\'' > scripts/run-dev.js ... EOF']`
  > Added [scripts/run-dev.js](../scripts/run-dev.js) to spawn data watch, config server, and Angular serve processes with dataset/clean awareness.
  > ---
  > **Bash** `['bash','-lc','cat <<'\''EOF'\'' > scripts/run-start.js ... EOF']`
  > Created [scripts/run-start.js](../scripts/run-start.js) to orchestrate the sequential start flow (data prep → config server → Angular serve) with matching flags.
  > ---
  > **Bash** `['bash','-lc','chmod +x scripts/run-dev.js scripts/run-start.js']`
  > Ensured the new runner scripts are executable.
  > ---
  > **Apply Patch** *(parameters summarized; updated [package.json](../package.json))*
  > Pointed `npm run dev` and `npm run start` to the new runner scripts.
  > ---
  > **Apply Patch** *(parameters summarized; updated [scripts/run-start.js](../scripts/run-start.js))*
  > Adjusted the start runner to launch config/Angular servers concurrently (matching the pre-existing behavior) instead of sequential `spawnSync` calls.
- [ ] Test `npm run dev` and `npm run start` with/without dataset & clean flags and record results.
  > **Bash** `['bash','-lc','npm run dev -- --dataset code-editor --clean']`
  > Attempted to run the new dev runner; clean step worked and processes launched, but Angular/Config servers failed immediately with `listen EPERM: operation not permitted` (ports 4200/3100 blocked in sandbox), so full verification requires a local environment that allows binding to those ports.
  > ---
  > **Bash** `['bash','-lc','npm run start -- --dataset code-editor --clean']`
  > Start runner completed data prep and kicked off config server, but the same `listen EPERM` restriction on port 3100 caused it to abort before Angular serve ran.
  >
  > Next step (pending): run `npm run dev`/`start` locally or in an environment where serving ports is permitted to finish validation.
