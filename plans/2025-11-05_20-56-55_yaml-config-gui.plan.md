# Plan: YAML Configuration GUI Requirements & Roadmap

Capture requirements and an implementation roadmap for a GUI helper to maintain shared YAML configuration files that define comparison feature sets.

## Tasks

- [x] Understand existing YAML configuration assets and supporting docs
  > **Bash** `command=["bash","-lc","rg --files -g'*.yml' -g'*.yaml'"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Surveyed repository YAML assets to confirm central configuration locations and dataset-specific copies.
  > ---
  > **Bash** `command=["bash","-lc","cat configuration/defaults/groups.yml"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Reviewed base feature group definitions and metadata fields used across datasets ([configuration/defaults/groups.yml](../configuration/defaults/groups.yml)).
  > ---
  > **Bash** `command=["bash","-lc","cat configuration/defaults/groups-advanced.yml"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Examined advanced grouping defaults to capture nested structure requirements ([configuration/defaults/groups-advanced.yml](../configuration/defaults/groups-advanced.yml)).
  > ---
  > **Bash** `command=["bash","-lc","head -n 40 configuration/defaults/value-displays.yml"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Inspected shared value display overrides for label rendering logic ([configuration/defaults/value-displays.yml](../configuration/defaults/value-displays.yml)).
  > ---
  > **Bash** `command=["bash","-lc","head -n 40 configuration/comparison-default.yml"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Checked global comparison defaults to understand schema conventions ([configuration/comparison-default.yml](../configuration/comparison-default.yml)).
  > ---
  > **Bash** `command=["bash","-lc","head -n 40 datasets/code-agent/config/comparison.yml"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Sampled dataset-specific overrides to identify divergence points from shared defaults ([datasets/code-agent/config/comparison.yml](../datasets/code-agent/config/comparison.yml)).
  > ---
  > **Bash** `command=["bash","-lc","head -n 80 configuration/datasets.manifest.json"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Reviewed manifest wiring to see how datasets reference shared configuration fragments ([configuration/datasets.manifest.json](../configuration/datasets.manifest.json)).
  > ---
  > **Bash** `command=["bash","-lc","sed -n '80,160p' README.md"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Gathered documentation on criteria metadata to capture validation rules ([README.md](../README.md)).
- [x] Produce requirements spec for YAML configuration maintenance GUI
  > **Tessl Create** `spec="specs/app/components/config-admin/config-admin-shell-component.spec.md"`
  > ```markdown
  > prompt:
  > Create a spec for a `ConfigAdminShellComponent` Angular component that will live at `src/app/components/config-admin/config-admin-shell.component.ts`. The component should expose a full GUI to maintain the shared YAML configuration fragments that define comparison criteria, value displays, and dataset defaults.
  > 
  > Key requirements:
  > - The component sits behind a route such as `/admin/config` and renders inside a responsive split layout with the configuration catalog on the left, editable detail pane in the middle, and a YAML preview/diff inspector on the right.
  > - On initialisation it requests a catalog of editable YAML resources from a dedicated `ConfigWorkspaceService` (to be implemented later) that enumerates shared defaults (`configuration/comparison-default.yml`, `configuration/defaults/*.yml`) and dataset-specific overrides (`datasets/*/config/comparison.yml`). The component must support filtering the catalog by dataset, config type, and free-text search.
  > - Selecting an item loads the parsed YAML document plus the raw text via the workspace service. The component translates YAML nodes for criteria groups, criteria entries, and value display overrides into strongly typed view models so the forms can edit fields such as `name`, `type`, `search`, `table`, `detail`, ordering metadata, child references, and value-display emojis.
  > - Editing uses reactive forms with field-level validation that enforces the same constraints documented in `README.md` (allowed `type` values, booleans for `search/table/detail`, numeric `order`, etc). Changes should be tracked so the UI can show dirty state, enable a save toolbar, and warn on navigation away with unsaved edits.
  > - Provide affordances to add, clone, reorder, and delete criteria groups or criteria, as well as add/remove value display overrides for categorical values. Reordering should update `order` fields and child arrays accordingly.
  > - Saving invokes the workspace service to generate updated YAML while preserving comments and overall structure when possible. The component should send both the structured model and raw YAML text so the service can perform a round-trip merge. After a successful save, the preview panel is refreshed and dirty state cleared.
  > - The preview/diff pane should display formatted YAML for the working copy alongside a diff against the last persisted version, highlighting additions, removals, and edits. Provide toggle between unified and side-by-side diff views and allow copying the rendered YAML.
  > - Include error handling and toasts for load/save failures, validation errors, or merge conflicts. Provide a quick-restore action to revert the working copy back to the persisted state.
  > - Expose breadcrumbs or metadata chips indicating dataset/default scope, last modified timestamp (supplied by workspace service), and whether the file is shared across datasets.
  > - Ensure keyboard accessibility, responsive resizing, and an explicit close/back action that confirms unsaved changes before navigating away.
  > 
  > Document dependencies on the forthcoming `ConfigWorkspaceService`, a `ConfigDiffViewerComponent` for rendering diffs, and a `ConfigCriteriaFormComponent` for editing criteria groups/items. Note any emitted events or public observables the shell exposes for other admin features.
  > ```
  > Generated [specs/app/components/config-admin/config-admin-shell-component.spec.md](../specs/app/components/config-admin/config-admin-shell-component.spec.md) capturing the GUI shell requirements.
  > ---
  > **Bash** `command=["bash","-lc","cat specs/app/components/config-admin/config-admin-shell-component.spec.md"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Verified generated spec content to confirm capabilities and dependencies.
- [x] Produce implementation roadmap for the GUI helper
  > **apply_patch** added `docs/config-admin-gui-implementation-plan.md` (full markdown content captured in file)
  > Created implementation roadmap covering phases, backend/frontend workstreams, testing, and rollout considerations.
  > ---
  > **Bash** `command=["bash","-lc","cat docs/config-admin-gui-implementation-plan.md"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Verified plan content after creation.
  > ---
  > **apply_patch** `*** Update File: docs/config-admin-gui-implementation-plan.md` ...  
  > Removed stray sentinel text appended during initial patch (see file for final content).
  > ---
  > **Bash** `command=["bash","-lc","tail -n 5 docs/config-admin-gui-implementation-plan.md"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Confirmed file ends cleanly after patch fix.
  > ---
  > **apply_patch** `*** Update File: docs/config-admin-gui-implementation-plan.md` ...  
  > Updated the plan to capture finalized decisions (local-only access, curated file scope, no live preview/snapshot requirements, reuse existing tooling).
- [x] Create backend config workspace server spec
  > **Tessl Create** `spec="specs/lib/gulp/config-workspace-server.spec.md"`
  > ```markdown
  > prompt:
  > Create a spec for a Node/Express server module at `lib/gulp/tasks/config-workspace-server.babel.js` that exposes REST endpoints for the configuration admin GUI while staying aligned with our existing Gulp-based tooling.
  > ...
  > ```
  > Generated [specs/lib/gulp/config-workspace-server.spec.md](../specs/lib/gulp/config-workspace-server.spec.md) defining API endpoints, locking, path safelists, and Gulp task integration for the backend server.
  > ---
  > **Bash** `command=["bash","-lc","cat specs/lib/gulp/config-workspace-server.spec.md"]`, `workdir="/home/cb/projects/github/ultimate/awesome-comparisons"`  
  > Reviewed final spec content.
- [x] Build backend config workspace server implementation
  > **Tessl Build** `spec=["specs/lib/gulp/config-workspace-server.spec.md"]`, `generateCode=["missing","outdated","dirty"]`, `modelName="auto"`
  > Generated [lib/gulp/tasks/config-workspace-server.babel.js](../lib/gulp/tasks/config-workspace-server.babel.js); dependency verification passed.
- [x] Document backend integration adjustments in plan (if necessary)
  > No additional updates required beyond the finalized decision block in [docs/config-admin-gui-implementation-plan.md](../docs/config-admin-gui-implementation-plan.md); noted completion after confirming backend constraints captured there.
- [x] Deliver summary and next steps to the user
  > No additional tool calls required. Prepared final response summarizing the new requirements spec and implementation roadmap and outlining suggested next actions.
