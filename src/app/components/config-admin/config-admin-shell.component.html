<!-- GENERATED FROM SPEC - DO NOT EDIT -->
<!-- @generated with Tessl v0.28.0 from ../../../../specs/app/components/config-admin/config-admin-shell-component.html.spec.md -->
<!-- (spec:43c7530d) (code:eef65002) -->

<mat-toolbar class="config-admin-shell__toolbar">
  <span class="config-admin-shell__title">Configuration Workspace</span>

  <!-- Metadata chips -->
  @if (selectedDocument$ | async; as document) {
    <div class="config-admin-shell__metadata">
      <mat-chip-set>
        @if (document.metadata?.datasetId) {
          <mat-chip>
            {{ document.metadata.datasetId }}
          </mat-chip>
        }
        @if (document.metadata?.isSharedDefault) {
          <mat-chip color="accent">
            Shared Default
          </mat-chip>
        }
        @if (document.metadata?.isDatasetConfig) {
          <mat-chip color="primary">
            Dataset Config
          </mat-chip>
        }
      </mat-chip-set>
    </div>
  }

  <div class="config-admin-shell__spacer"></div>

  <!-- Action buttons -->
  <div class="config-admin-shell__actions">
    <button
      mat-icon-button
      [disabled]="!hasUnsavedChanges"
      (click)="saveDocument()"
      matTooltip="Save changes">
      <mat-icon>save</mat-icon>
    </button>

    <button
      mat-icon-button
      [disabled]="!hasUnsavedChanges"
      (click)="discardChanges()"
      matTooltip="Revert changes">
      <mat-icon>undo</mat-icon>
    </button>

    <button
      mat-icon-button
      (click)="toggleDiffView()"
      matTooltip="Toggle diff view">
      <mat-icon>compare</mat-icon>
    </button>

    <button
      mat-icon-button
      (click)="copyYamlToClipboard()"
      matTooltip="Copy YAML to clipboard">
      <mat-icon>content_copy</mat-icon>
    </button>

    <mat-divider vertical></mat-divider>

    <button
      mat-icon-button
      (click)="close()"
      matTooltip="Close workspace">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Loading spinner -->
  @if (isLoading$ | async) {
    <mat-spinner
      diameter="24"
      class="config-admin-shell__spinner">
    </mat-spinner>
  }
</mat-toolbar>

<section class="config-admin-shell__alert-log" role="region" aria-label="Alert history">
  <mat-card>
    <mat-card-title>Alert History</mat-card-title>
    @if (alertMessages$ | async; as alerts) {
      <div class="config-admin-shell__alert-log-body">
        @if (alerts.length === 0) {
          <div
            class="config-admin-shell__alert-log-empty">
            <mat-icon>info</mat-icon>
            <span>No alerts yet</span>
          </div>
        }
        @for (alert of alerts; track trackAlert($index, alert)) {
          <div
            class="config-admin-shell__alert-log-entry"
            [class.alert-log-entry--warn]="alert.level === 'warn'"
            [class.alert-log-entry--error]="alert.level === 'error'">
            <span class="alert-log-entry__timestamp">{{ alert.timestamp | date:'HH:mm:ss' }}</span>
            <span class="alert-log-entry__level">{{ alert.level | uppercase }}</span>
            <span class="alert-log-entry__text">{{ alert.text }}</span>
          </div>
        }
      </div>
    }
  </mat-card>
</section>

<div class="config-admin-shell__layout" role="main">
  <div class="config-admin-shell__catalog config-admin-shell__panel" role="navigation">
    @if ({ isLoading: (isLoading$ | async) || false, catalog: (catalogItems$ | async) || [] }; as vm) {
      <uc-config-catalog-tree
        [catalog]="vm.catalog"
        [selectedEncodedPath]="(selectedDocument$ | async)?.encodedPath || null"
        [isSaving]="(isSaving$ | async) || false"
        [loading]="vm.isLoading"
        (select)="onCatalogSelect($event)"
        (retry)="loadCatalog()"
        (drawerToggle)="onCatalogDrawerToggle()">
      </uc-config-catalog-tree>
      <!-- Empty state for catalog -->
      @if (vm.catalog.length === 0 && !vm.isLoading) {
        <div
          class="config-admin-shell__empty">
          <mat-icon>folder_open</mat-icon>
          <p>No configuration documents found</p>
        </div>
      }
    }
  </div>

  <div class="config-admin-shell__editor config-admin-shell__panel" role="region">
    <!-- Sticky summary bar -->
    @if (selectedDocument$ | async; as document) {
      <div
        class="config-admin-shell__summary-bar">
        <span>{{ totalGroups }} groups, {{ totalCriteria }} criteria</span>
        @if (hasUnsavedChanges) {
          <span
            class="config-admin-shell__dirty-indicator">
            (unsaved changes)
          </span>
        }
      </div>
    }
    @if (selectedDocument$ | async; as document) {
      <uc-config-criteria-form
        [document]="document"
        [allowedTypes]="allowedTypes"
        [isReadonly]="false"
        (documentChange)="onDocumentChange($event)"
        (dirtyChange)="onDirtyChange($event)"
        (requestCloneGroup)="onCloneGroup($event)"
        (requestCloneCriteria)="onCloneCriteria($event)"
        (requestDeleteGroup)="onDeleteGroup($event)"
        (requestDeleteCriteria)="onDeleteCriteria($event)"
        (valueDisplayChange)="onValueDisplayChange($event)"
        (saveRequested)="saveDocument()"
        (revertRequested)="discardChanges()"
        (formatRequested)="refreshPreview()">
      </uc-config-criteria-form>
    }

    <!-- Empty state for editor -->
    @if (!(selectedDocument$ | async)) {
      <div
        class="config-admin-shell__empty">
        <mat-icon>edit</mat-icon>
        <p>Select a configuration document to edit</p>
      </div>
    }
  </div>

  <div class="config-admin-shell__preview config-admin-shell__panel" role="region">
    @if (selectedDocument$ | async; as document) {
      <div>
        <!-- Tabs/toggle for diff vs raw view -->
        <mat-button-toggle-group
          [value]="previewMode"
          (change)="onPreviewModeChange($event.value)"
          class="config-admin-shell__view-toggle">
          <mat-button-toggle value="diff">Diff</mat-button-toggle>
          <mat-button-toggle value="raw">Raw YAML</mat-button-toggle>
        </mat-button-toggle-group>
        @if (previewMode === 'diff') {
          <uc-config-diff-viewer
            [originalYaml]="document.rawYaml || ''"
            [modifiedYaml]="currentYaml"
            [viewMode]="diffViewMode"
            [theme]="diffTheme"
            [isBusy]="(isLoading$ | async) || false"
            [lastSavedTimestamp]="document.metadata.lastModified"
            (viewModeChange)="onDiffViewModeChange($event)"
            (optionsChange)="onDiffOptionsChange($event)">
          </uc-config-diff-viewer>
        }
        <!-- Alternate textarea for raw YAML -->
        @if (previewMode === 'raw') {
          <textarea
            class="config-admin-shell__yaml-textarea"
            [value]="currentYaml"
            readonly
            cdkScrollable>
          </textarea>
        }
      </div>
    }

    <!-- Empty state for preview -->
    @if (!(selectedDocument$ | async)) {
      <div
        class="config-admin-shell__empty">
        <mat-icon>preview</mat-icon>
        <p>Select a document to preview changes</p>
      </div>
    }
  </div>
</div>
